<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ecosystem Overfishing Ideas • atlantiseof</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ecosystem Overfishing Ideas">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">atlantiseof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manuscript" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manuscript</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manuscript">
<li><h6 class="dropdown-header" data-toc-skip>None</h6></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-supplementary" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Supplementary</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-supplementary">
<li><a class="dropdown-item" href="../articles/eofIdeas.html">MAB ideas</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-presentations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Presentations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-presentations">
<li><a class="external-link dropdown-item" href="https://noaa-edab.github.io/presentations/20220428_SSCEcoWG_Gaichas.html#1">MAFMC SSC Ecosystem WG (04,2022)</a></li>
    <li><a class="external-link dropdown-item" href="https://noaa-edab.github.io/presentations/20230227_SSCEcoWG_Beet.html#1">MAFMC SSC Ecosystem WG (02,2023)</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-posters" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Posters</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-posters">
<li><h6 class="dropdown-header" data-toc-skip>None</h6></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NOAA-EDAB/atlantiseof"><span class="fa fa-lg fa-github"></span> source code</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ecosystem Overfishing Ideas</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NOAA-EDAB/atlantiseof/blob/main/vignettes/eofIdeas.rmd" class="external-link"><code>vignettes/eofIdeas.rmd</code></a></small>
      <div class="d-none name"><code>eofIdeas.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="ecosystem-overfishing">Ecosystem overfishing<a class="anchor" aria-label="anchor" href="#ecosystem-overfishing"></a>
</h2>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><mi>P</mi><mi>P</mi><mi>.</mi><mi>T</mi><msubsup><mi>E</mi><mi>i</mi><mrow><mi>T</mi><msub><mi>L</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">C_i = PP.TE_i^{TL_i-1}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
= maximum productivity of species <em>i</em>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">TE</annotation></semantics></math>
= trophic efficiency of species <em>i</em>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">TL</annotation></semantics></math>
= trophic level of species <em>i</em>. PP is assmed to be net primary
productivity and is fixed over time and space</p>
<p>The total productivity of a system with <em>n</em> species would
be</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msubsup><mo>∑</mo><mi>i</mi><mi>n</mi></msubsup><mi>P</mi><mi>P</mi><mi>.</mi><mi>T</mi><msubsup><mi>E</mi><mi>i</mi><mrow><mi>T</mi><msub><mi>L</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">C = \sum_i^n PP.TE_i^{TL_i-1}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">TE</annotation></semantics></math>
is often assumed to be 10% -16%</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">TL</annotation></semantics></math>
for a system is often assumed to be 3-4 (a global average of ~3.4)</p>
<p>We are not interested in global estimates. We are interested in
regional specific estimates.</p>
<p>A scalar,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
is often included to represent the proportion of C that is available to
harvest. Studies point to using a value of about 0.15-.2</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>α</mi><msubsup><mo>∑</mo><mi>i</mi><mi>n</mi></msubsup><mi>P</mi><mi>P</mi><mi>.</mi><mi>T</mi><msubsup><mi>E</mi><mi>i</mi><mrow><mi>T</mi><msub><mi>L</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">C = \alpha \sum_i^n PP.TE_i^{TL_i-1}</annotation></semantics></math></p>
<p>So
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
represents the total catch in the system</p>
<div class="section level3">
<h3 id="ryther-index">Ryther index<a class="anchor" aria-label="anchor" href="#ryther-index"></a>
</h3>
<p>Using (see <a href="https://www.science.org/doi/10.1126/sciadv.aav0474" class="external-link">Link and
Watson</a> for more info)</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>P</mi><mo>=</mo><mn>45</mn><mi>G</mi><mi>t</mi><mi>C</mi><mi>y</mi><mi>e</mi><mi>a</mi><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">PP = 45Gt C year{-1}</annotation></semantics></math>,</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>E</mi><mo>=</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">TE =12%</annotation></semantics></math>,</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.15</mn></mrow><annotation encoding="application/x-tex">\alpha = .15</annotation></semantics></math>,</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>L</mi><mo>=</mo><mn>3.4</mn></mrow><annotation encoding="application/x-tex">TL = 3.4</annotation></semantics></math></p>
<p>yields a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mn>.42</mn><mi>G</mi><mi>t</mi><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">C = .42 Gt year^{-1}</annotation></semantics></math>.
(Total removals from the ocean)</p>
<p>Ryther index
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>k</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">t km^{-2} year^{-1}</annotation></semantics></math>)
- total removal per unit area. On a global scale, the total surface area
of the ocean ~ 361 million
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">km^{-2}</annotation></semantics></math></p>
<p>Upper bound of Ryther threshold is calculated as:</p>
<p>Ryther =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>.42</mn><mi>G</mi><mi>t</mi><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mn>10</mn><mn>9</mn></msup></mrow><mrow><mn>361</mn><mi>k</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><msup><mn>10</mn><mn>6</mn></msup></mrow></mfrac><mo>=</mo><mn>1.14</mn><mi>t</mi><mi>k</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\frac{.42 Gt year^{-1} 10^9}{361 km^{-2}10^6} = 1.14 t km^{-2}year^{-1}</annotation></semantics></math></p>
<p>This would represent the current state of fishing worldwide and
considered an acceptable upper bound (based on values of PP, TE, TL,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>).
Other thresholds calculated based on varying these values. We can
calculate an envelope by using a range of TL, TE, PP,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
values.</p>
</div>
<div class="section level3">
<h3 id="mab-ryther-index--global-thresholds">MAB Ryther index. Global thresholds<a class="anchor" aria-label="anchor" href="#mab-ryther-index--global-thresholds"></a>
</h3>
<p>From Ecodata 2022. Thresholds based on global estimates of primary
production.
<img src="eofIdeas_files/figure-html/ecodataRytherGlobal-1.png" alt="MAB Ryther index with global thresholds" width="700"></p>
<ul>
<li>Threshold = .276 (PP = 400, alpha = 0.1, TE = .1, TL = 3.6)</li>
<li>Threshold = 1.14 (PP = 450, alpha = 0.15, TE = .12, TL = 3.4)</li>
<li>Threshold = 2.73 (PP = 500, alpha = 0.15, TE = .14, TL = 3.2)</li>
<li>Threshold = 3.64 (PP = 500, alpha = 0.20, TE = .14, TL = 3.2)</li>
</ul>
</div>
<div class="section level3">
<h3 id="mab-ryther-index--regional-thresholds">MAB Ryther index. Regional thresholds<a class="anchor" aria-label="anchor" href="#mab-ryther-index--regional-thresholds"></a>
</h3>
<p>From Ecodata 2022. Thresholds based on regional estimates of primary
production.
<img src="eofIdeas_files/figure-html/ecodataRytherMAB-1.png" alt="MAB Ryther index with regional thresholds" width="700"></p>
<ul>
<li>Threshold = .68 (PP = 400, alpha = 0.1, TE = .1, TL = 3.6)</li>
<li>Threshold = 2.8 (PP = 450, alpha = 0.15, TE = .12, TL = 3.4)</li>
<li>Threshold = 6.72 (PP = 500, alpha = 0.15, TE = .14, TL = 3.2)</li>
<li>Threshold = 8.96 (PP = 500, alpha = 0.20, TE = .14, TL = 3.2)</li>
</ul>
<p>Calculate this on our regional footprint using PP, TL information
from region, not relying on Global estimates, since different areas of
the world will be more/less productive than others.</p>
</div>
</div>
<div class="section level2">
<h2 id="atlantis-information">Atlantis information<a class="anchor" aria-label="anchor" href="#atlantis-information"></a>
</h2>
<div class="section level3">
<h3 id="primary-producers">Primary producers<a class="anchor" aria-label="anchor" href="#primary-producers"></a>
</h3>
<p>We need an estimate of PP
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>C</mi><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">t C year^{-1}</annotation></semantics></math>
for NEUS region as our base for estimating system productivity.</p>
<p>Note: Global estimate of PP = 40-50 Gt C
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">year^{-1}</annotation></semantics></math>
(Giga tons= 10^9 tons)</p>
<ul>
<li><p>All primary production (PP) in NEUS atlantis model is
forced.</p></li>
<li><p>Data is in annual
<code>currentVersion/tsfiles/Annual_Files/Phyto_Forcing_xxxx.nc</code>
nc files</p></li>
<li>
<p>nc file contains three phytoplankton functional groups. All are
present in the top layer of each box (the euphotic zone, all boxes have
an upper 50m layer) and are NA’s elsewhere</p>
<ul>
<li>Micro phytoplankton (&gt; 20
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">\mu m</annotation></semantics></math>)
- Split into Atlantis Diatoms and Atlantis Dinoflagellates (Large)</li>
<li>Nano phytoplankton (2-20
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">\mu m</annotation></semantics></math>)
(Medium) - Atlantis pico</li>
<li>Pico phytoplankton (&lt; 2
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">\mu m</annotation></semantics></math>)
(Small) - Atlantis pico</li>
</ul>
</li>
</ul>
<p>Currently only large phytoplankton (Diatoms) have a pathway to the
upper part of the foodweb in Atlantis. Dont consider Atlantis’s
dinoflagellates (harmful algal blooms) or pico as part of primary
production available</p>
<ul>
<li>diatoms (1 mm)</li>
<li>dinoflagellates (.015-.04 mm)</li>
<li>picophytoplankton (0.2-10
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>m)
- up to 70% of all productivity</li>
<li>Units =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>g</mi><mi>N</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mg N m^{-3}</annotation></semantics></math>
</li>
</ul>
<p>Dinoflagellates consumed by filter feeders (deposit feeders, DF,
benthic filter feeders, BFF, atlantic states demersal fish, SDF) and
bacteria</p>
<p>pico phytoplankton consumed by small zooplankton which are consumed
by Meso zooplankton (ZM, Copepods) which are consumed by krill.</p>
<p>Diatoms are consumed by meso zooplankton (ZM), large zooplankton
(ZL), planktivores (MAK, HER, MEN)</p>
<ul>
<li><p>Read in nc file using <code>ncdf4::open.nc()</code></p></li>
<li><p>R package <code>rbgm</code> to get
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>g</mi><mi>N</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mg N m^{-3}</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">mg N</annotation></semantics></math>
in each box (<code>rbgm::bgmfile(file)</code>)</p></li>
</ul>
<p>Will need to read in, combine and convert to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>C</mi><mi>u</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>A</mi><mi>r</mi><mi>e</mi><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><mi>e</mi><mi>a</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">tons C unitArea^{-1} year^{-1}</annotation></semantics></math>
Always more Carbon than Nitrogen in organic matter. C:N of 5.7 used in
atlantis.</p>
</div>
<div class="section level3">
<h3 id="spatial-footprint">Spatial footprint<a class="anchor" aria-label="anchor" href="#spatial-footprint"></a>
</h3>
<p>Atlantis boxes have been mapped to NEUS EPUs (see Caracappa et
al)</p>
<pre><code><span><span class="co">## Spherical geometry (s2) switched off</span></span></code></pre>
<p><img src="eofIdeas_files/figure-html/domain-1.png" alt="Map of NEUS Atlantis boxes and EPU boundaries" width="700"></p>
<p>The MAB ~= 117861
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">km^2</annotation></semantics></math></p>
<p>All following plots use the NEUS spatial footprint (Boxes 1:22) ~
264,000
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">km^{2}</annotation></semantics></math></p>
<p><img src="eofIdeas_files/figure-html/N-1.png" alt="Primary production in NEUS Atlantis boxes" width="700"><img src="eofIdeas_files/figure-html/N-2.png" alt="Primary production in NEUS Atlantis boxes" width="700"><img src="eofIdeas_files/figure-html/N-3.png" alt="Primary production in NEUS Atlantis boxes" width="700"><img src="eofIdeas_files/figure-html/N-4.png" alt="Primary production in NEUS Atlantis boxes" width="700"></p>
<!-- Overall mean daily value of PP = 82391 $tons N day^{-1}$ -->
<!-- Which translates to 171416 $Ktons C year^{-1}$ -->
<!-- Surface area of NEUS = NULL $km^{-2}$ -->
<!-- Scaled up to a global level (multiply by 361 million/NULL)  -->
</div>
</div>
<div class="section level2">
<h2 id="mab-threshold">MAB threshold<a class="anchor" aria-label="anchor" href="#mab-threshold"></a>
</h2>
<p>Using three values for system PP. Min, mean, max of annual time
series</p>
<p>Values of Primary production = 3.0775844^{8}, 3.6174809^{8},
4.0002739^{8} The area of the MAB in atlantis = 1.1807533^{5}</p>
<p>Using these values and the “centroid” values (term used in Link et
al) of TL = 3.4, TE = .12, and alpha = .15.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">rPP</span> <span class="kw">in</span> <span class="va">PP</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">threshold</span> <span class="op">=</span> <span class="fl">.15</span><span class="op">*</span><span class="va">rPP</span><span class="op">*</span><span class="op">(</span><span class="fl">.12</span><span class="op">^</span><span class="op">(</span><span class="fl">3.4</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">area</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">threshold</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.410888</span></span>
<span><span class="co">## [1] 2.833827</span></span>
<span><span class="co">## [1] 3.133696</span></span></code></pre>
<p>Compare these with the upper threshold of 1.14 t km-2 year-1 based on
Global estimates of PP. Much higher thresholds.</p>
</div>
<div class="section level2">
<h2 id="trophic-level">Trophic level<a class="anchor" aria-label="anchor" href="#trophic-level"></a>
</h2>
<p>Defintion:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>+</mo><msub><mo>∑</mo><mi>j</mi></msub><mi>T</mi><msub><mi>L</mi><mi>j</mi></msub><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">TL_i= 1 + \sum_jTL_jF_{ij}</annotation></semantics></math></p>
<p>for predator i, prey j.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">F_{ij}</annotation></semantics></math>
is fraction of j in diet of i</p>
<p>In matrix form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mi>n</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>13</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>23</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>31</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>32</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mn>33</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mn>3</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mi>n</mi><mn>3</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>F</mi><mrow><mi>n</mi><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>.</mi><mi>.</mi><mi>.</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi><msub><mi>L</mi><mi>n</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\begin{bmatrix}
TL_{1} \\
TL_{2} \\
TL_{3} \\
...\\
TL_{n} \\
\end{bmatrix} =
\begin{bmatrix}
1 \\
1 \\
1 \\
...\\
1 \\
\end{bmatrix} +
\begin{bmatrix}
F_{11} &amp; F_{12} &amp; F_{13} &amp; ... &amp;  F_{1n} \\
F_{21} &amp; F_{22} &amp; F_{23} &amp; ... &amp;  F_{2n} \\
F_{31} &amp; F_{32} &amp; F_{33} &amp; ... &amp;  F_{3n}  \\
...\\
F_{n1} &amp; F_{n2} &amp; F_{n3} &amp; ... &amp;  F_{nn}  \\
\end{bmatrix}
\begin{bmatrix}
TL_{1} \\
TL_{2} \\
TL_{3} \\
...\\
TL_{n} \\
\end{bmatrix}</annotation></semantics></math></p>
<p>which simplifies to</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>T</mi><mi>L</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mn>1</mn><mi>T</mi></msup><mo>+</mo><mi>F</mi><mi>.</mi><mi>T</mi><mi>L</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>T</mi><mi>L</mi><mo>−</mo><mi>F</mi><mi>.</mi><mi>T</mi><mi>L</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mn>1</mn><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>−</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi><mi>L</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mn>1</mn><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>T</mi><mi>L</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>−</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mn>1</mn><mi>T</mi></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
TL &amp;= 1^T + F.TL \\
TL - F .TL &amp;= 1^T \\
(I-F)TL &amp;= 1^T \\
TL &amp;= (I-F)^{-1}1^T
\end{align}</annotation></semantics></math></p>
<p>Have several options to calculate trophic level</p>
<ul>
<li>Pull species trophic level data from fishbase</li>
<li>Estimate species trophic level from atlantis input params (pprey
values denote prey preference)</li>
<li>Estimate species trophic level from atlantis realized diet
output</li>
<li>Assume a system wide average trophic level (from Stock et al.)</li>
</ul>
<p>How we calculate that:</p>
<p>Primary production required to support the total catch TLeq was equal
to the primary production required based on summing the individual
catch</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>C</mi><mi>i</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mi>T</mi><mi>E</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>T</mi><msub><mi>L</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mfrac><mn>1</mn><mrow><mi>T</mi><mi>E</mi></mrow></mfrac><mrow><mi>T</mi><msub><mi>L</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n C_i \left(\frac{1}{TE}\right)^{TL_i -1} = \left(\sum_{i=1}^n C_i \right)\frac{1}{TE}^{TL_{eq}-1}</annotation></semantics></math></p>
<p>This is easier said than done. Atlantis outputs consumption by
predator for prey, box, time in <code>detailedDietCheck.txt</code> but
it can be a large file ~ 27GB which can not be read into R without first
processing it outside of R.</p>
<p>Alternatively, consumption can be obtained from <code>prod.nc</code>
file and used in combination with <code>dietData.txt</code>file.</p>
<ul>
<li><p>Functions <code>edit_param_pprey -&gt; get_pprey_values</code> in
R directory of repo tp pull the prrey values from the biology.prm
file</p></li>
<li><p>Processed Atlantis output <code>data_dietcheck.rds</code>
columns: time, pred, agecl (of pred), prey, atoutput (units)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="estimating-trophic-level-from-detailed-diet">Estimating Trophic level from detailed diet<a class="anchor" aria-label="anchor" href="#estimating-trophic-level-from-detailed-diet"></a>
</h2>
<p>Detailed diet data is first processed outside of R. (Instructions in
documentation of <code>est_trophic_level</code>)</p>
<div class="section level3">
<h3 id="single-representative-tl-per-species">Single representative TL per species<a class="anchor" aria-label="anchor" href="#single-representative-tl-per-species"></a>
</h3>
<p>This value for each species uses diet data combined over space, time,
age class</p>
<p><img src="figures/atlantisTrophicLevelDiet.png" alt="Estimated trophic levels from Atlantis realized diet data"></p>
</div>
<div class="section level3">
<h3 id="tl-changes-over-time">TL changes over Time<a class="anchor" aria-label="anchor" href="#tl-changes-over-time"></a>
</h3>
<p>As you may expect, pretty constant.</p>
<p><img src="figures/atlantisTrophicLevelDietTime.png" alt="Estimated trophic levels from Atlantis realized diet data over time"></p>
</div>
<div class="section level3">
<h3 id="tl-from-parameter-files">TL from parameter files<a class="anchor" aria-label="anchor" href="#tl-from-parameter-files"></a>
</h3>
<p>In the parameter files we define the diet preference. This is not
always realized based on availability of prey due to over lap, abundance
or size</p>
<p><img src="figures/atlantisTrophicLevelDietParams.png" alt="Estimated trophic levels from Atlantis diet parameters"></p>
</div>
<div class="section level3">
<h3 id="compare-trophic-levels">Compare trophic levels<a class="anchor" aria-label="anchor" href="#compare-trophic-levels"></a>
</h3>
<p>Compare trophic level estimates. realized diet vs diet parameters</p>
<p><img src="figures/compareTrophicLevels.png" alt="Comparison of trophic level estimates from Atlantis realized diet data and diet parameters"></p>
</div>
</div>
<div class="section level2">
<h2 id="envelope-of-thresholds">Envelope of thresholds<a class="anchor" aria-label="anchor" href="#envelope-of-thresholds"></a>
</h2>
<p>Study: see how threshold estimates change</p>
<ul>
<li>a range of Trophic efficiencies (TE)</li>
<li>incorporating different methods for calculating trophic levels
(TL)</li>
<li>Determine metrics to assess health of Ecosystem when thresholds are
breached. Does a breach in a threshold indicate poor ecosystem health as
measured by some metric</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andy Beet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
